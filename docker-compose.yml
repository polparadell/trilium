version: '3'
services:
  trilium:
    image: zadam/trilium
    restart: unless-stopped
    volumes:
      - trilium-data:/home/node/trilium-data
    deploy:
      labels:
        - "traefik.enable=true"
        - "traefik.http.routers.trilium.rule= Host(`rpi1.polbel.casa`) && PathPrefix(`/trilium`)"
        - "traefik.http.services.trilium.loadbalancer.server.port=8080"
      placement:
        constraints:
          - node.labels.type!=nas

volumes:
  trilium-data:
